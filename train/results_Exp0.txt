training start time :    2020-07-07 00:28:21.445778
########################################################################################################
#                                                                                                      #
#                                  PARAMETERS AND HYPER PARAMETERS                                     #
#                                                                                                      #
########################################################################################################

from datetime import datetime, timedelta

print('~~~~~~~~~~~~~IMPORT PARAMETERS~~~~~~~~~~~~~')

# Default Parameters
experiment = 'Exp0'  # Experiment name
experiment_path = f'/home/pnn/experiments/{experiment}/'

num_days = None  ### should be None
split_cycle = 1

lwir_max_len = 64  # prefer 64
lwir_skip = 6
vir_max_len = 16  # need to understand how many of these are the max that exist
color_max_len = 16  # "

load_checkpoint = False
use_checkpoints = True

# define start and end dates of the experiment here, this should be a dictionary according to the experiment

# Exp0
start_date = datetime(2019, 6, 4)
end_date = datetime(2019, 7, 7)

# Exp1
# start_date = datetime(2019, 7, 28)
# end_date   = datetime(2019, 8, 4)

# Exp2
# start_date = datetime(2019, 9, 20)
# end_date   = datetime(2019, 10, 13)

# Exp3
# start_date = datetime(2019, 10, 28)
# end_date   = datetime(2019, 12, 7)


# Exp3_5
# start_date = datetime()
# end_date   = datetime()

# Exp3_6
# start_date = datetime()
# end_date   = datetime()

# Exp4
# start_date = datetime()
# end_date   = datetime()

# Choose Device
cdevice = "cuda:0"

# training hyper-parameters       #     added again , '577nm'
excluded_modalities = ['noFilter', 'polar', 'polar_a']  # All of the modalities that you don't want to use
train_ratio = 5 / 6  # dataset train/test ratio
batch_size = 4  # training batch size
loss_delta = 0.0  # The minimum above the best loss that is allowed for the model to be  saved
return_epochs = 0  # Epochs without improvement allowed (loss_delta included). Return to the best checkpoint otherwise. 0 to disable
epochs = 50  # number of epochs during train
lamda = 0.5e-1  # generic lerning rate to start all learners from
label_lr = lamda  # phenotype classifier learning rate
plant_lr = lamda  # plant classifier LR used for transfer learning
extractor_lr = lamda  # feature extractor LR
domain_adapt_lr = lamda  # domain adaptation learning rate

#  Clustering Parameters
compare_clusters = True  # Compare cluster evaluation results for used modalities
num_clusters = 6  # The number of clusters used in the evaluations, default is Exp number of phenotypes
load_features = False  # action='store_true', default=False
cluster_tsne_results = '/home/orielban/PNN-AI/PNN-AI/tsne_results/'
# load features -- when true Loads the features from a file, else - computed from the extractor and saved in a csv file.

# Clustering - TSNE
plot_TSNE = True  # Save a TSNE plot for used modalities
PCA = 0  # default = 0, no PCA usage . If PCA > 0 -- features will be transformed by PCA with that number of components.
--------------------------------------------------------------------------------------------
	epoch 1: label loss:    1.863 plant loss:    3.759 accuracy:    0.050 
	epoch 2: label loss:    1.840 plant loss:    3.742 accuracy:    0.025 
	epoch 3: label loss:    1.836 plant loss:    3.740 accuracy:    0.031 
	epoch 4: label loss:    1.828 plant loss:    3.740 accuracy:    0.019 
	epoch 5: label loss:    1.834 plant loss:    3.736 accuracy:    0.025 
	epoch 6: label loss:    1.845 plant loss:    3.733 accuracy:    0.019 
	epoch 7: label loss:    1.817 plant loss:    3.737 accuracy:    0.031 
	epoch 8: label loss:    1.828 plant loss:    3.740 accuracy:    0.031 
	epoch 9: label loss:    1.850 plant loss:    3.738 accuracy:    0.025 
	epoch 10: label loss:    1.822 plant loss:    3.738 accuracy:    0.031 
	epoch 11: label loss:    1.847 plant loss:    3.738 accuracy:    0.013 
	epoch 12: label loss:    1.821 plant loss:    3.739 accuracy:    0.044 
	epoch 13: label loss:    1.828 plant loss:    3.741 accuracy:    0.044 
	epoch 14: label loss:    1.860 plant loss:    3.736 accuracy:    0.031 
	epoch 15: label loss:    1.840 plant loss:    3.739 accuracy:    0.013 
	epoch 16: label loss:    1.821 plant loss:    3.738 accuracy:    0.044 
	epoch 17: label loss:    1.813 plant loss:    3.738 accuracy:    0.038 
	epoch 18: label loss:    1.824 plant loss:    3.736 accuracy:    0.044 
	epoch 19: label loss:    1.847 plant loss:    3.740 accuracy:    0.025 
	epoch 20: label loss:    1.833 plant loss:    3.735 accuracy:    0.031 
	epoch 21: label loss:    1.834 plant loss:    3.736 accuracy:    0.031 
	epoch 22: label loss:    1.836 plant loss:    3.736 accuracy:    0.038 
	epoch 23: label loss:    1.823 plant loss:    3.738 accuracy:    0.025 
	epoch 24: label loss:    1.840 plant loss:    3.738 accuracy:    0.006 
	epoch 25: label loss:    1.828 plant loss:    3.742 accuracy:    0.038 
	epoch 26: label loss:    1.822 plant loss:    3.737 accuracy:    0.019 
	epoch 27: label loss:    1.837 plant loss:    3.741 accuracy:    0.025 
	epoch 28: label loss:    1.819 plant loss:    3.737 accuracy:    0.044 
	epoch 29: label loss:    1.830 plant loss:    3.738 accuracy:    0.031 
	epoch 30: label loss:    1.850 plant loss:    3.736 accuracy:    0.025 
	epoch 31: label loss:    1.831 plant loss:    3.736 accuracy:    0.031 
	epoch 32: label loss:    1.838 plant loss:    3.739 accuracy:    0.038 
	epoch 33: label loss:    1.821 plant loss:    3.736 accuracy:    0.025 
	epoch 34: label loss:    1.838 plant loss:    3.737 accuracy:    0.031 
	epoch 35: label loss:    1.823 plant loss:    3.740 accuracy:    0.025 
	epoch 36: label loss:    1.838 plant loss:    3.740 accuracy:    0.019 
	epoch 37: label loss:    1.833 plant loss:    3.741 accuracy:    0.019 
	epoch 38: label loss:    1.818 plant loss:    3.737 accuracy:    0.031 
	epoch 39: label loss:    1.823 plant loss:    3.736 accuracy:    0.025 
	epoch 40: label loss:    1.874 plant loss:    3.737 accuracy:    0.044 
	epoch 41: label loss:    1.833 plant loss:    3.738 accuracy:    0.013 
	epoch 42: label loss:    1.813 plant loss:    3.734 accuracy:    0.044 
	epoch 43: label loss:    1.837 plant loss:    3.738 accuracy:    0.031 
	epoch 44: label loss:    1.818 plant loss:    3.736 accuracy:    0.025 
	epoch 45: label loss:    1.832 plant loss:    3.735 accuracy:    0.025 
	epoch 46: label loss:    1.827 plant loss:    3.739 accuracy:    0.031 
	epoch 47: label loss:    1.827 plant loss:    3.734 accuracy:    0.019 
	epoch 48: label loss:    1.839 plant loss:    3.738 accuracy:    0.038 
	epoch 49: label loss:    1.831 plant loss:    3.737 accuracy:    0.031 
	epoch 50: label loss:    1.827 plant loss:    3.736 accuracy:    0.025 
Train_label_losses   :1.8626941800117494 1.8396975636482238 1.836103582382202 1.8282899737358094 1.834159219264984 1.844512701034546 1.8173221349716187 1.8282121658325194 1.8501295089721679 1.8216126918792725 1.8471791982650756 1.8208103775978088 1.8284508347511292 1.8599522233009338 1.8397844791412354 1.8206289887428284 1.8125708103179932 1.8244458198547364 1.846792185306549 1.8332976937294005 1.8343246221542358 1.8359525203704834 1.8234941601753234 1.8396609425544739 1.8277250528335571 1.8221683263778687 1.8368601679801941 1.8194966793060303 1.830236291885376 1.850019645690918 1.8305856943130494 1.83804030418396 1.820685040950775 1.837511146068573 1.823231029510498 1.8380183577537537 1.833092164993286 1.8183622241020203 1.8233063340187072 1.8739114284515381 1.8327523946762085 1.812799596786499 1.8374552488327027 1.8183358669281007 1.832270860671997 1.8268802165985107 1.8270309448242188 1.8390912890434266 1.8306424617767334 1.8268311858177184Train_plant_losses   :3.7588782787322996 3.7422174215316772 3.739813494682312 3.739524078369141 3.7359477281570435 3.733221745491028 3.7373344898223877 3.740151023864746 3.7375771760940553 3.7378311157226562 3.738040637969971 3.7388779878616334 3.740624022483826 3.7355449199676514 3.7390908718109133 3.7382667779922487 3.7379288911819457 3.73644015789032 3.740454363822937 3.7350333452224733 3.736299467086792 3.7363734245300293 3.7375848293304443 3.7381555795669557 3.741870880126953 3.736730933189392 3.7409462213516234 3.7372549533843995 3.737802815437317 3.7362223863601685 3.7355443477630614 3.73914110660553 3.736145544052124 3.7371275186538697 3.7396488189697266 3.7398714303970335 3.7408313274383547 3.736865186691284 3.7364999294281005 3.737129807472229 3.7383360147476195 3.734175181388855 3.7380964517593385 3.7361740112304687 3.735288715362549 3.7387539863586428 3.7337279081344605 3.7381232738494874 3.7373469352722166 3.735838770866394Train_accuracy_prog  :tensor(0.0500, device='cuda:0') tensor(0.0250, device='cuda:0') tensor(0.0312, device='cuda:0') tensor(0.0188, device='cuda:0') tensor(0.0250, device='cuda:0') tensor(0.0188, device='cuda:0') tensor(0.0312, device='cuda:0') tensor(0.0312, device='cuda:0') tensor(0.0250, device='cuda:0') tensor(0.0312, device='cuda:0') tensor(0.0125, device='cuda:0') tensor(0.0437, device='cuda:0') tensor(0.0437, device='cuda:0') tensor(0.0312, device='cuda:0') tensor(0.0125, device='cuda:0') tensor(0.0437, device='cuda:0') tensor(0.0375, device='cuda:0') tensor(0.0437, device='cuda:0') tensor(0.0250, device='cuda:0') tensor(0.0312, device='cuda:0') tensor(0.0312, device='cuda:0') tensor(0.0375, device='cuda:0') tensor(0.0250, device='cuda:0') tensor(0.0063, device='cuda:0') tensor(0.0375, device='cuda:0') tensor(0.0188, device='cuda:0') tensor(0.0250, device='cuda:0') tensor(0.0437, device='cuda:0') tensor(0.0312, device='cuda:0') tensor(0.0250, device='cuda:0') tensor(0.0312, device='cuda:0') tensor(0.0375, device='cuda:0') tensor(0.0250, device='cuda:0') tensor(0.0312, device='cuda:0') tensor(0.0250, device='cuda:0') tensor(0.0188, device='cuda:0') tensor(0.0188, device='cuda:0') tensor(0.0312, device='cuda:0') tensor(0.0250, device='cuda:0') tensor(0.0437, device='cuda:0') tensor(0.0125, device='cuda:0') tensor(0.0437, device='cuda:0') tensor(0.0312, device='cuda:0') tensor(0.0250, device='cuda:0') tensor(0.0250, device='cuda:0') tensor(0.0312, device='cuda:0') tensor(0.0188, device='cuda:0') tensor(0.0375, device='cuda:0') tensor(0.0312, device='cuda:0') tensor(0.0250, device='cuda:0')